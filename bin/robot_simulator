#!/usr/bin/env ruby

require_relative '../lib/simulator'
require_relative '../lib/table'
require_relative '../lib/robot'

table = Table.new(width: 5, height: 5)
robot = Robot.new()
simulator = Simulator.new(table: table, robot: robot)

puts "Enter a command (PLACE X,Y, (NORTH EAST SOUTH WEST) and then | MOVE | LEFT | RIGHT | REPORT | EXIT):"

loop do
  input = gets.chomp.upcase

  case input
  when /^PLACE\s+(\d+),(\d+),(NORTH|SOUTH|EAST|WEST)$/
    x, y, direction = $1.to_i, $2.to_i, $3
    simulator.place_robot(x, y, direction)
  when "MOVE"
    simulator.move_robot
  when "LEFT"
    simulator.rotate_robot('LEFT')
  when "RIGHT"
    simulator.rotate_robot('RIGHT')
  when "REPORT"
    puts simulator.report
  when "EXIT"
    break
  else
    puts "Invalid command! You need to start with PLACE X,Y, robot facing NORTH/EAST/SOUTH/WEST and then use MOVE, LEFT, RIGHT, REPORT or EXIT."
  end
end
